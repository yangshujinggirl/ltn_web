$(function(){function t(t){i.isSuccess(t)&&(t=t.data,i.set("noPwdTZUrl",t.url),i.noPwdTZUrl=t.url,e())}function e(){i.goNoPsd(),$("#message").show(),$("#submit").text("投资中...").prop("disabled","disabled")}var o,n,a,i=new Page,s=constant().clientType,r=constant().sessionKey,u="",c=1;i.w_getData=function(){o=i.get("productId"),c=i.get("is_Bridcoin"),$.getJSON(constant().url+"/help/productDetail",{clientType:s,productId:o},function(t){n=t,u=t.data.singleLimitAmount,$.getJSON(constant().url+"/user/orderhz/orderhzprepare",{clientType:s,productId:o,sessionKey:r,orderAmount:u,cashbackCoupon:"0",birdCoin:"0"},function(t){"0"==t.resultCode?(a=t,t.data.orderAmount=u,t.data.payAmount=1==c?u-t.data.birdCoin:u,t.data.proDetail=n,t.data.is_Bridcoin=c,template().renduTemplate("confirm_content","confirm_content_d",t.data),i.wsubmit()):(alert("请先登陆。"),window.location.href="/html/user/login/?url=/html")})})},i.wsubmit=function(){$("#buy").on("click",function(){$("#buy").addClass("notPoint").attr("disabled","disabled").text("提交中..."),i.getData("/pc/user/info",{},function(e){var n=e.data;if("1"==n.agreementTZ){var d=1==c?a.data.birdCoin:0;$.post(constant().url+"/user/orderconfirm",{birdCoin:d,clientType:s,orderAmount:u,productId:o,sessionKey:r},function(t){"0"==t.resultCode?$(".mutual-success").show():($("#resultMessage").text(t.resultMessage),$(".mutual-fail").show())})}else i.getData("/user/agreement",{agreement_type:"ZTBB0G00"},[t])})})},i.goNoPsd=function(){var t={agreement_type:"ZTBB0G00",unbind:"0"};user().goNewPage(t,"7"),i.showDialog("#noPsdPopup")},i.goNoPsd=function(){var t={agreement_type:"ZTBB0G00",unbind:"0"};user().goNewPage(t,"7"),i.showDialog("#noPsdPopup")},i.buy=function(){function t(){user().loginOperate(o())}function e(){window.location.href="/html/mutual/mutual_details/confirm/#!/"+n}function o(){return function(){"1"==a?"-1"==s?window.location.href="/html/user/corporate_fail/":"0"==s?window.location.href="/html/user/corporate_success/":"2"==s?window.location.href="/html/user/corporate_realname1/":"1"==s&&user().nameAuthOperate(e):user().nameAuthOperate(e)}}var n=i.get("productId"),a=this.userType,s=this.userStatus;$("#mutual_join_btn").on("click",t)},i.init=function(){this.userStatus=session().get("userStatus"),this.userType=session().get("userType"),i.set("productId",Url.getHashParts(0)),i.set("is_Bridcoin",Url.getHashParts(1)),this.w_getData(),$("#msg-done").on("click",function(){i.hideDialog("#message"),location.reload()}),$("#msg-fail").on("click",function(){location.href="../../../help/about"}),i.setTitle("领投鸟理财-不动产理财颠覆者-互助下单")},i.init()});