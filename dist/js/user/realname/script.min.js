$(function(){var e=new Page;e.setTitle("实名认证");var t={guid:"",getImageCode:function(){var e={clientType:constant().clientType,machineNo:guid};$.post(constant().url+"/user/register/pictureCode",e,function(e,i){if("success"==i&&"0"==e.resultCode){var a=constant().url+e.data.pictureCode;template().renduTemplate("templateImageCode","imageCon",a),$("#imageCode").on("click",function(){t.getImageCode()}),$("input:not(:checkbox,:radio),select,textarea").on("blur",function(){_this=$(this);var e=_this.parent().parent(),i=e.find(".validation"),a="validate-success",n="validate-failed";validate().vd(_this,e,i,a,n,!1),t.addEvent(_this,e,i)}),$("input:not(:checkbox,:radio),select,textarea").on("focus",function(){var e=$(this).parent().parent();e.removeClass(validate().vdFailed);var t=e.find(".validation");t.html(""),$("#loginTip").hide()})}})},addEvent:function(e,i,a){if("txtCode"==e.attr("id")&&!i.hasClass("validate-failed")&&strUtil().trim(e.val()).length>0)return void t.getCodeIsTrue(e)},getCodeIsTrue:function(e){var i=strUtil().trim(e.val()),a=e.parent().parent(),n=a.find(".validation"),o={clientType:constant().clientType,machineNo:guid,pictureCode:i};$.post(constant().url+"/pc/login/validatePicCode",o,function(e,i){"success"==i&&"0"==e.resultCode&&("1"==e.data.isPicCodeRight?a.addClass("validate-success").removeClass("validate-failed"):(a.addClass("validate-failed").removeClass("validate-success"),n.html("您输入的验证码不正确"),t.getImageCode()))}),console.log(i)},testRealname:function(e,t,i){var a={userName:e,identityCode:t,pictureCode:i,machineNo:guid};user().goNewPage(a,"5"),$("#message").show(),$("#cover").show()},nameOperation:function(){user().isNameAuth()&&(window.location.href="/")},init:function(){user().updateUserInfo(t.nameOperation),guid=strUtil().getGuid(),t.getImageCode()}};t.init(),$("#submit").not(".disabled").on("click",function(){if(user().testSubmit(t.addEvent),0!=$("#form").find(".validate-failed").length)return!1;var e=strUtil().trim($("#txtName").val()),i=strUtil().trim($("#txtIdentity").val()),a=strUtil().trim($("#txtCode").val());t.testRealname(e,i,a)}),$("#realnameSuccess").on("click",function(){$("#cover").hide(),user().updateUserInfo();var e=decodeURIComponent(urlUtil(location.href).get("url"));strUtil().isEmpty(e)||e.indexOf("product")==-1&&e.indexOf("loan")==-1?location.href="/html/user/card":location.href=e}),$("#goHelp").on("click",function(){$("#cover").hide(),user().updateUserInfo(),user().goBack("/help/certificate")}),$(".shut").on("click",function(){$(this).parent().parent().hide()}),$("#isRead").on("change",function(){var e=$(this),t=$("#submit");e.attr("checked")?(e.attr("checked",!1),t.addClass("disabled"),t.attr("disabled","true")):(e.attr("checked","true"),t.removeClass("disabled"),t.removeAttr("disabled"))}),$("#close").on("click",function(){$("#message").hide(),$("#cover").hide()})});