window.RP=function(){var e=constant().clientType,t=constant().sessionKey,n=constant().url,i=new Page,o=this;return this.init=function(){o.is_over(),o.recordLoading(),o.recordNum(),o.getCondition()},this.getCondition=function(){$.post(n+"/market/activity/info",{clientType:"PC",invoke:"3rdActChance",serviceName:"OCTOBER",sessionKey:t},function(e){if("0"==e.resultCode){var e=e.data.result;"1"==e.isHaveChance?$("#hasStatus").text("您符合条件，可以参与本次活动"):($("#hasStatus").text("您不符合本次活动条件，查看>>"),$("#hasStatus").on("click",function(){$("#userInfo").show(),$("#userInfoMoney").html(e.orderAmount),$("#userInfoNum").html(e.orderCount)}))}else"10000006"==e.resultCode?(i.errorIndex++,1==i.errorIndex&&alert("请先登录")):(i.errorIndex++,1==i.errorIndex&&alert(e.resultMessage))})},this.recordLoading=function(){$.post(n+"/market/activity/info",{clientType:"PC",invoke:"2stActWinnings",serviceName:"OCTOBER",sessionKey:t},function(e){if("0"==e.resultCode){var e=e.data.result;i.initTemplate(e,"platformList","tempPlatformList"),$("#B_PlatformPrizeRecord").find(".platform-record-data").kxbdMarquee({direction:"up",isEqual:!1})}else"10000006"==e.resultCode?(i.errorIndex++,1==i.errorIndex&&console.log("获取平台中奖记录，需要先登录")):(i.errorIndex++,1==i.errorIndex&&alert(e.resultMessage))}),$.post(n+"/market/activity/info",{clientType:"PC",invoke:"2stActPersonalWinnings",serviceName:"OCTOBER",sessionKey:t},function(e){if("0"==e.resultCode){var e=e.data.result;i.initTemplate(e,"personList","tempPersonList"),$("#A_PlatformPrizeRecord").find(".platform-record-data").kxbdMarquee({direction:"up",isEqual:!1})}else"10000006"==e.resultCode?(i.errorIndex++,1==i.errorIndex&&alert("请先登录")):(i.errorIndex++,1==i.errorIndex&&alert(e.resultMessage))})},this.recordNum=function(){$.post(n+"/market/activity/info",{clientType:"PC",invoke:"3rdActBirdCoinAll",serviceName:"OCTOBER",sessionKey:t},function(e){if(console.log("平台数据"),console.log(e),"0"==e.resultCode){var e=e.data.result;i.initTemplate(e,"paltformNum","tempPaltformNum")}else"10000006"==e.resultCode?(i.errorIndex++,1==i.errorIndex&&alert("请先登录")):(i.errorIndex++,1==i.errorIndex&&alert(e.resultMessage))}),$.post(n+"/market/activity/info",{clientType:"PC",invoke:"3rdActBirdCoinPersonal",serviceName:"OCTOBER",sessionKey:t},function(e){if(console.log("个人数据"),console.log(e),"0"==e.resultCode){var e=e.data.result;i.initTemplate(e,"personNum","tempPersonNum")}else"10000006"==e.resultCode||"10000005"==e.resultCode?($(".investment_but").on("click",function(){window.location.href="/html/user/login/?url=/html/market/redpacket/"}),$("#personNum").hide(),i.errorIndex++,1==i.errorIndex&&(alert("请先登陆。"),window.location.href="/html/user/login/?url=/html/market/redpacket/")):(i.errorIndex++,1==i.errorIndex&&alert(e.resultMessage))})},this.get=function(i,o,r){winningTimes=0,o.winningTimes&&(winningTimes=o.winningTimes),$.getJSON(n+"/market/activity/info",{clientType:e,sessionKey:t,invoke:i,winningTimes:winningTimes,serviceName:"OCTOBER"},function(e){"0"==e.resultCode?r(e.data.result):(console.log(e),alert("请先登陆。"),window.location.href="/html/user/login/?url=/html/market/redpacket/")})},this.is_over=function(){o.get("isOver",{},function(e){"0"!==e&&(alert("活动已经结束"),window.location.href="/html/")})},this.firstGet=function(e,t){o.get("1stActRewards",e,function(e){"0"!==e&&t(e)})},this.hasChance=function(e){o.get("1stActChance",{},function(t){e("1"==t?!0:!1)})},this.submitRP=function(e){$("#RP_limit").hide(),$("#RP_max").hide(),o.get("1stActConfirm",{},function(t){"0"!==t&&e(t)})},this.secondGet=function(e){o.get("1stActWinnings",{},function(t){"0"!==t&&e(t)})},function(){o.init()}()},$(function(){function e(){$(".prize_two").show(),$("#complete").show(),s.secondGet(function(e){if(console.log(e),$(".teo_list li").hide(),e.length>0)for(var t=0;t<e.length;t++)$("#a"+e[t]).show()})}function t(e){$(".count_down_numbers").show();var t=2;clock=setInterval(function(){$(".count_down_numbers img:eq("+(t+1)+")").hide(),$(".count_down_numbers img:eq("+t+")").show(),t==-1&&e(clock),t--},1e3)}function n(e){$("#stick_black .stick").addClass("stick_run");var t=9;countDownClock=setInterval(function(){$(".second").text(t),t--,0==t&&clearInterval(countDownClock)},1e3)}function i(e){clearInterval(e),$(".count_down_numbers").hide(),n("start"),createSnow(a,20,r)}function o(e){clearInterval(e),$(".count_down_numbers").hide(),n("reload"),reloadSnow(a,20,r)}function r(e){l=e,s.firstGet({winningTimes:l.RP_num},function(e){if($(".teo_list li").hide(),e)for(var t=0;t<e.length;t++)$("#a"+e[t]).show()}),$("#stick_black .stick").removeClass("stick_run"),$(".second").text("10"),0==e.RP_num?$(".red_rian_one").show():e.RP_num<5?($(".prize_two").show(),$("#RP_limit").show(),$("#RP_num").text(e.RP_num)):($(".prize_two").show(),$("#RP_limit").hide(),$("#RP_max").show())}var s=new RP,a={src:"/img/redpacket/red_icon1.png",width:"88",height:"88"},l={},c=constant().url,d=constant().sessionKey,u=new Page;u.vigorNum=0,u.isEnd=!1,u.sessionKey=constant().sessionKey,window.countDownClock,window.clock,u.silverAward={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},u.goldAward={1:"7",2:"8",3:"9",4:"10",5:"11",6:"12"},$(".look1").on("click",function(){$(".prize_img").show()}),$(".look2").on("click",function(){$(".prize_img2").show()}),$(".cha1").on("click",function(){$(".prize_img").hide()}),$(".cha2").on("click",function(){$(".prize_img2").hide()}),$(".cha3").on("click",function(){$("#userInfo").hide()}),$("#closeNoVigor").on("click",function(){$("#noVigor").hide()}),$(".address .cha2").on("click",function(){$(".address").hide()}),$("#goback").on("click",function(){$(".prize_two").hide(),$(".redpacket_rain").hide()}),$(".setaddress").on("click",function(){$(".address").show()}),$(".dresser").on("click",function(){u.isEnd?alert(u.endText):u.isLogin()?u.vigorNum>=1?($(".cover").show(),$(".daren_bg3").attr("src","/img/redpacket/darenbaoxiang.gif"),u.getLottery("silver")):u.noVigorPopup():alert("未登录")}),$(".cachet").on("click",function(){u.isEnd?alert(u.endText):u.isLogin()?u.vigorNum>=10?($(".cover").show(),$(".daren_bg4").attr("src","/img/redpacket/zhizunbaoxiang.gif"),u.getLottery("gold")):u.noVigorPopup():alert("未登录")}),u.noVigorPopup=function(){$(".cover").show(),$("#noVigor").show(),$("#noVigor .life_left").on("click",function(){$(".cover").hide(),$("#noVigor").hide()})},u.isLogin=function(){return""!=u.sessionKey&&"undefined"!=typeof u.sessionKey},u.getUserVigor=function(){$.post(c+"/market/activity/info",{clientType:"PC",invoke:"2ndActIntegral",integralType:"OCTOBER",serviceName:"OCTOBER",sessionKey:d},function(e){if("0"==e.resultCode){var e=e.data.result;u.vigorNum=e,console.log("活力值"),console.log(u.vigorNum),$("#hasVitality").text("您当前有"+e+"点活力值")}else"10000006"==e.resultCode?(u.errorIndex++,1==u.errorIndex&&(alert("请先登陆。"),window.location.href="/html/user/login/?url=/html/market/redpacket/")):(u.errorIndex++,1==u.errorIndex&&alert(e.resultMessage))})},u.getLottery=function(e){$.post(c+"/market/activity/info",{clientType:"PC",exchangeType:e,invoke:"2ndActLuckDraw",serviceName:"OCTOBER",sessionKey:d},function(t){if("0"==t.resultCode){var t=t.data.result;if(u.getUserVigor(),"silver"==e){console.log("达人宝箱"),console.log(t);var n=u.silverAward[t];"1"==n?(setTimeout(function(){$(".daren_bg3").attr("src","").hide(),$(".Notwinning").show(),$(".againGo").addClass("type1"),u.initBtnAgain("type1")},1e3),$(".Notwinning .life_left").on("click",function(){$(".Notwinning").hide(),$(".cover").hide()})):(setTimeout(function(){$(".daren_bg3").attr("src","").hide(),$(".box_prize").show(),$(".box_prize .prize_img2")[0].className="prize_img2",$(".box_prize .prize_img2").addClass("tup"+n),$(".againGo").addClass("type1"),u.initBtnAgain("type1")},1e3),$(".box_prize .life_left").on("click",function(){$(".box_prize").hide(),$(".cover").hide()}))}else{console.log("至尊宝箱"),console.log(t);var n=u.goldAward[t];setTimeout(function(){$(".daren_bg4").attr("src","").hide(),$(".box_prize").show(),$(".box_prize .prize_img2")[0].className="prize_img2",$(".box_prize .prize_img2").addClass("tup"+n),$(".againGo").addClass("type2"),u.initBtnAgain("type2")},1e3),$(".box_prize .life_left").on("click",function(){$(".box_prize").hide(),$(".cover").hide()})}}else"10000006"==t.resultCode?(u.errorIndex++,1==u.errorIndex&&(alert("请先登陆。"),window.location.href="/html/user/login/?url=/html/market/redpacket/")):(u.errorIndex++,1==u.errorIndex&&alert(t.resultMessage))})},u.initBtnAgain=function(e){"type1"==e?u.vigorNum<1?$(".againGo").addClass("noClick"):$(".againGo").removeClass("noClick"):u.vigorNum<10?$(".againGo").addClass("noClick"):$(".againGo").removeClass("noClick")},u.init=function(){u.getUserVigor()},u.init(),$(".againGo").on("click",function(){var e=$(this);return!e.hasClass("noClick")&&($(".box_prize").hide(),$(".Notwinning").hide(),void(e.hasClass("type1")?($(".daren_bg3").show().attr("src","/img/redpacket/darenbaoxiang.gif"),u.getLottery("silver")):($(".daren_bg4").show().attr("src","/img/redpacket/darenbaoxiang.gif"),u.getLottery("gold"))))}),$("#sure").on("click",function(){var e="^1[3|4|5|7|8][0-9]{9}$",t=new RegExp(e),n=$("#province1").val(),i=$("#city1").val(),o=$("#district1").val(),r=$("#txtAddress").val(),s=$("#txtName").val(),a=$("#txtTel").val();if(""==n)return alert("请选择省份"),!1;if(""==i)return alert("请选择市"),!1;if(""==r)return alert("请填写地址"),!1;if(""==s)return alert("请填写姓名"),!1;if(""==a)return alert("请填写手机号"),!1;if(!t.test(a))return alert("请填写正确的手机号码"),!1;var l=n+i+o+r+","+s+","+a;$.post(c+"/market/activity/info",{clientType:"PC",invoke:"confirmAddr",serviceName:"OCTOBER",sessionKey:d,parameter:l},function(e){if("0"==e.resultCode){var e=e.data.result;"1"==e?alert("提交成功"):alert("提交失败")}else"10000006"==e.resultCode?(u.errorIndex++,1==u.errorIndex&&alert("请先登录")):(u.errorIndex++,1==u.errorIndex&&alert(e.resultMessage))}),$(".address").hide()}),$(".accept").on("click",function(){s.submitRP(function(t){t?e():(console.log("领取成功"),$("#RP_limit").hide(),$("#RP_max").hide(),$("#complete").show())})}),$(".qiang").on("click",function(){s.hasChance(function(n){n?($(".redpacket_rain").show(),$("body").scrollTop(0).css("overflow","hidden"),t(i)):(console.log("已经抢过"),e())})}),$(".red_rian_one .agin, .red_rian_agin").on("click",function(){s.hasChance(function(n){n?($(".prize_two").hide(),$(".red_rian_one").hide(),t(o)):(console.log("已经抢过"),e())})}),$(".close_rain").on("click",function(){$("body").css("overflow","scroll"),$(".redpacket_rain").hide(),removeSnow(),$("#stick_black .stick").removeClass("stick_run"),$(".prize_two").hide(),$(".red_rian_one").hide()})}),function(){function e(e){if("function"!=typeof window.onload)window.onload=e;else{var t=window.onload;window.onload=function(){t(),e()}}}function t(){var e={};for(type in{Top:"",Left:""}){var t="Top"==type?"Y":"X";"undefined"!=typeof window["page"+t+"Offset"]?e[type.toLowerCase()]=window["page"+t+"Offset"]:(t=document.documentElement.clientHeight?document.documentElement:document.body,e[type.toLowerCase()]=t["scroll"+type])}return e}function n(){var e,t=document.body;return window.innerHeight?e=window.innerHeight:t.parentElement.clientHeight?e=t.parentElement.clientHeight:t&&t.clientHeight&&(e=t.clientHeight),e}function i(e){this.parent=document.body,this.createEl(this.parent,e.src),this.el.style.width=e.width+"px",this.el.style.height=e.height+"px",this.maxLeft=document.body.offsetWidth-parseFloat(e.width),this.maxTop=document.body.offsetHeight-parseFloat(e.height),this.left=(6*Math.random()+2)/10*this.maxLeft,this.top=t().top+1,this.angle=1.4+.2*Math.random(),this.minAngle=1.4,this.maxAngle=1.6,this.angleDelta=.01*Math.random(),this.speed=4+Math.random()}var o=!1;e(function(){o=!0});var r=!0,s=1e4,a=20,l={message:"nothing",RP_num:0},c=0,d=!1;window.createSnow=function(c,u,h){if(o=!0,s=1e4,d=!1,o)var f=[],g=setInterval(function(){if(s<=0||l.RP_num>=5){clearInterval(g);for(var e=f.length-1;e>=0;e--)f[e].remove();return void(d||h(l))}s-=a,r&&u>f.length&&Math.random()<.00125*u&&f.push(new i(c)),!r&&!f.length&&clearInterval(g);for(var o=t().top,m=n(),e=f.length-1;e>=0;e--)f[e]&&(f[e].top>1e3||f[e].top+f[e].size+1>o+m?(f[e].remove(),f[e]=null,f.splice(e,1)):(f[e].move(),f[e].draw()))},a);else e(function(){createSnow(c,u,h)})},window.removeSnow=function(){c=0,o=!1,r=!0,s=0,clearInterval(window.countDownClock),clearInterval(window.clock),$("#stick_black .stick").removeClass("stick_run"),$(".second").text("10"),d=!0},window.reloadSnow=function(e,t,n){r=!0,l.RP_num=0,c=0,o=!0,createSnow(e,t,n)},i.prototype={createEl:function(e,t){function n(){Math.random()>.5||2==c?(i.el.src="/img/redpacket/red_icon2.png",l.RP_num++,c=0):i.el.src="/img/redpacket/red_icon3.png",i.el.removeEventListener("click",n),c++}this.el=document.createElement("img"),this.el.setAttribute("src",t),this.el.style.position="absolute",this.el.style.top="0",this.el.style.left="0",this.el.style.display="block",this.el.style.zIndex="99999",this.parent.appendChild(this.el);var i=this;this.el.addEventListener("click",n)},move:function(){(this.angle<this.minAngle||this.angle>this.maxAngle)&&(this.angleDelta=-this.angleDelta),this.angle+=this.angleDelta,this.top-=this.speed*Math.sin(this.angle*Math.PI),this.left<0?this.left=this.maxLeft:this.left>this.maxLeft&&(this.left=0)},draw:function(){this.el.style.transform="translate("+Math.round(this.left)+"px,"+Math.round(this.top)+"px)"},remove:function(){this.parent.removeChild(this.el),this.parent=this.el=null}}}();