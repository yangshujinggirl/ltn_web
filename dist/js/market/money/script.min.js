$(function(){function e(){for(var e=Math.sqrt(2*u/m),t=m*e,n=0;n<e;n++)c.push((2*t*n-m*n*n)/2);c.push(u)}function t(){a.style.webkitTransform="rotate("+c[d++]+"deg)",a.style.MozTransform="rotate("+c[d++]+"deg)",a.style.msTransform="rotate("+c[d++]+"deg)",a.style.OTransform="rotate("+c[d++]+"deg)",d<c.length?requestAnimFrame(t):(w=!1,setTimeout(function(){if(null!=r){var e="";if("1"==r)e="Pad mini2";else{if("2"==r)return e="谢谢",$("#noPrize").show(),void $("#cover-bg").show();"3"==r?e="漫步者耳机":"4"==r?e="小米移动电源":"5"==r?e="11元返现券":"6"==r&&(e="38元返现券")}$("#prizePopup").show(),$("#cover-bg").show(),$("#prizeName").text(e)}},200))}function n(n){n=n||l[parseInt(l.length*Math.random())],w=!0,clearInterval(s),u=1800+n,c=[],d=0,e(),requestAnimFrame(t)}var o=new Page;o.getsurplus=function(){function e(e){if(o.isSuccess(e)){var e=e.data;f=e.chance,$("#surplusCount").text(e.chance),o.initTemplate(e,"list","tempList")}}function t(e){var t=e.data.isStart;0==t?$("#qidai").show():1==t&&$("#start").show()}return o.getData("/activity/top",{},[e,t])},o.init=function(){o.getsurplus()},o.init(),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var r,a,s,u=1080,c=[],l=[30,90,150,210,270,330],f=0,d=0,m=.01,w=!1;a=document.getElementById("turntable"),i=10,o.getTurnTable=function(){function e(e){var i=e.resultCode;if("10000006"==i)return session().clear(),void user().loginOperate();if("10000005"==i)return session().clear(),$("#loginPopup").show(),void $("#cover-bg").show();if(0==f)return $("#noChance").show(),void $("#cover-bg").show();if(0==i)t(),r=e.data.prizesId,f=e.data.chance,$("#surplusCount").text(f),n(l[r-1]),w=!0;else{var o=user().testResultCode(i);alert(o)}}function t(){w=!0,s=setInterval(function(){i+=5,a.style.webkitTransform="rotate("+i+"deg)",a.style.MozTransform="rotate("+i+"deg)",a.style.msTransform="rotate("+i+"deg)",a.style.OTransform="rotate("+i+"deg)"},1)}return o.getData("/activity/turntable",{},[e])},window.start=n,$("#start").click(function(){w||o.getTurnTable()}),$("#btnLogin").on("click",function(){user().loginOperate()}),$(".close").on("click",function(){$(this).parents(".popup").hide(),$("#cover-bg").hide()}),$("#registered").on("click",function(){user().isLogin()?window.location.href="/html/":window.location.href="/html/user/register/"}),$("#noChanceBtn").on("click",function(){window.location.href="/finance/list/0/1/0/0"}),$("#noPrizeBtn").on("click",function(){$("#cover-bg").hide(),$("#noPrize").hide()})});