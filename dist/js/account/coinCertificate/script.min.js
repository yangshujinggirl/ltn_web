$(function(){var e=(new Page,Url.getSearchParts("type")),t={guid:"",getImageCode:function(){var e=constant().url+"/user/register/pictureCode/"+guid;$("#imgCode").attr("src",e),$("#imgCode").on("click",function(){guid=strUtil().getGuid(),t.getImageCode()}),$("input,select,textarea").on("blur",function(){_this=$(this);var e=_this.parent().parent(),t=e.find(".validation"),i="validate-success",a="validate-failed";validate().vd(_this,e,t,i,a,!1),""==$(this).val()&&(e.addClass("validate-failed").removeClass("validate-success"),t.html(this.placeholder))}),$("input,select,textarea").on("focus",function(){var e=$(this).parent().parent();e.removeClass(validate().vdFailed);var t=e.find(".validation");t.html("")})},addEvent:function(e,i,a){if("cashCode"!=e.attr("id"))if("txtCode"!=e.attr("id"));else if(!i.hasClass("validate-failed")&&strUtil().trim(e.val()).length>0){if(0!=$("#form").find(".validate-failed").length)return!1;t.submit()}},submit:function(e){var i=$("#cashCode").val(),a=$("#txtCode").val(),o={clientType:constant().clientType,code:i,machineNo:guid,pictureCode:a,sessionKey:constant().sessionKey};$.post(constant().url+"/user/exchangeCode/exchange",o,function(e,i){if("success"==i)if("0"==e.resultCode){var e=e.data;$("#copy").show(),$("#copy .couponName").html(e.coupons[0].couponName),$(".cover").show(),$("#look").on("click",function(){"投资返现"==e.coupons[0].activityType?window.location.href="/html/account/returnTickits/":window.location.href="/html/account/raiseTickits/"})}else"10000001"==e.resultCode?($("#imageCon #txtCode").val(""),guid=strUtil().getGuid(),t.getImageCode(),$("#imageCon").addClass("validate-failed").removeClass("validate-success"),$("#imageCon .validation").html(e.resultMessage)):(guid=strUtil().getGuid(),t.getImageCode(),$("#codeCon").addClass("validate-failed").removeClass("validate-success"),$("#codeCon .validation").html(e.resultMessage))})},init:function(){user().loginOperate(),guid=strUtil().getGuid(),t.getImageCode()}};t.init(),$("#submit").on("click",function(){user().testSubmit(t.addEvent)}),$("#copyBtn,#closeBtn").on("click",function(){$("#copy").hide(),$(".common-cover").hide()}),$("#return").on("click",function(){"TZFX"==e?window.location.href="/html/account/returnTickits/":window.location.href="/html/account/raiseTickits/"})});