$(function(){var t=new Page;t.initList=function(e){function i(e){t.isSuccess(e)&&(e=e.data,t.initTemplate(e,"list","tempList"))}function a(e){if(t.isSuccess(e)){e=e.data;var i=t.get("status");i.total=e.totalCount}}function n(e){t.get("status");$(".item.prodList").on("click",function(e){var i=$(this).attr("data-type"),a=$(this).attr("data-tag");"LCT"==i?i="信用宝"==a||"消费分期"==a||a.indexOf("供应链")!==-1?"long":"short":"LCTXL"==i?i="long":"XSB"==i&&(i="first"),t.jump(i,$(this).data("id"))})}function r(){function e(t){return t.currPage}function i(t){switch(t.prodSel){case"zuixin":return"ZXBD";case"xinshou":return"XSB";case"short":return"LCT";case"long":return"LCTXL"}}function a(t){return"zuixin"==t.prodSel?"":t.period[t.periodSel].value.split("|")}function n(t){return"zuixin"==t.prodSel?"":t.period[t.periodSel].unit}function r(t){return"zuixin"==t.prodSel?"1":t.status[t.statusSel].value}var u=t.get("status"),o={clientType:"PC"},s=i(u)||"ZXBD",l=a(u)||["0","0"],c=n(u)||"D",d=r(u)||"0",p=t.get("pageSize")||3;return currPage=e(u)||1,u.pageSize=p,u.currPage=currPage,o.currentPage=currPage-1,o.pageSize=p,o.productType=s,o.productStatus=d,o.productDeadlineStart=l[0],o.productDeadlineEnd=l[1],o.deadlineUnitStart=c,o.deadlineUnitEnd=c,o}return t.getData("/product/pcProductSearch",r(),[i,a,n])},t.initFilter=function(){function e(){var e=i();t.initTemplate(e,"filter","tempFilter"),"zuixin"==e.prodSel&&$("#wrap-filter").hide(),t.set("status",e)}function i(){var t=Url.getHashParts(),e=t[0]||"zuixin",i=t[1]||0,a=t[2]||0,n=t[3]||1;switch(e){case"long":u=[{label:"全部",value:"0|0",unit:"M"},{label:"1个月",value:"0|1",unit:"M"},{label:"3个月",value:"1|3",unit:"M"},{label:"6个月",value:"3|6",unit:"M"},{label:"12个月",value:"6|12",unit:"M"}];break;case"short":case"zuixin":case"xinshou":u=[{label:"全部",value:"0|0",unit:"D"},{label:"5天",value:"0|5",unit:"D"},{label:"15天",value:"5|15",unit:"D"},{label:"30天",value:"15|30",unit:"D"},{label:"45天",value:"30|45",unit:"D"}]}return{prod:o,prodSel:e,period:u,periodSel:i,status:s,statusSel:a,currPage:n}}function a(){var e=i(),a=$("#prod-tab"),n=$("#prod-period").find(".item"),r=$("#prod-status").find(".item");a.removeClass(e.prod.join(" ")),a.addClass(e.prodSel),"zuixin"==e.prodSel?$("#wrap-filter").hide():($("#wrap-filter").show(),n.each(function(t){$(this).text(e.period[t].label),$(this).removeClass("selected")}),n.eq(e.periodSel).addClass("selected"),r.removeClass("selected"),r.eq(e.statusSel).addClass("selected")),t.set("status",e),t.refresh()}function n(t,e){var a=i();a[t]=e,"zuixin"==e?Url.setHash([a.prodSel,0,0,1]):Url.setHash([a.prodSel,a.periodSel,a.statusSel,1])}function r(){var t=$("#prod-tab"),e=$("#prod-period").find(".item"),i=$("#prod-status").find(".item");$(window).on("hashchange",function(){a()}),t.on("click",function(t){n("prodSel",$(t.target).data("prod"))}),e.on("click",function(t){n("periodSel",$(t.target).data("period"))}),i.on("click",function(t){n("statusSel",$(t.target).data("status"))})}var u,o=($("#prod-tab"),$("#prod-period").find(".item"),$("#prod-status").find(".item"),["zuixin","xinshou","short","long"]),s=[{label:"全部",value:"0"},{label:"可投资",value:"1"},{label:"已结束",value:"2"},{label:"已还款",value:"4"}];e(),r()},t.initPaging=function(){function e(){for(var e=t.get("status"),i=+e.total,a=+e.pageSize,n=+e.currPage,r=5,u=Math.ceil(i/a),o=Math.ceil(n/r),s=Math.min(u,o*r),l=0,c=(o-1)*r+1,d={pages:[]};c+l<=s;l++)d.pages[l]=c+l;d.currPage=n,t.initTemplate(d,"paging","tempPaging")}function i(){var e=t.get("status"),i=+e.total,a=+e.pageSize,n=+e.currPage,r=5,u=Math.ceil(i/a),o=Math.ceil(n/r),s=(Math.min(u,o*r),$(".product-page")),l=s.find(".page"),c=s.find(".prev"),d=s.find(".next");c.on("click",function(){e.currPage=Math.max(1,n-5),t.refresh()}),d.on("click",function(){e.currPage=Math.min(u,n+5),t.refresh()}),l.on("click",function(){e.currPage=$(this).text(),t.refresh()}),$(".action").mouseover(function(){$(this).find(".iconjieshu").hide(),$(this).find(".blueIcon").show(),$(this).find(".tankuang").show()}),$(".action").mouseout(function(){$(this).find(".iconjieshu").show(),$(this).find(".blueIcon").hide(),$(this).find(".tankuang").hide()})}e(),i()},t.updateHash=function(){var e=t.get("status");Url.setHash([e.prodSel,e.periodSel,e.statusSel,e.currPage])},t.refresh=function(){t.when(t.initList,[t.initPaging,t.updateHash])},t.init=function(){t.initFilter(),t.refresh()},t.init(),"/finance/list/0/1/0/0"==window.location.pathname&&$(".commonNavTwo,.commonNav").find(".right a").eq(1).addClass("select")});